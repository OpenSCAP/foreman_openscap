<% content_for(:javascripts) do %>
  <%= webpacked_plugins_js_for :foreman_openscap %>
<% end %>
<% content_for(:stylesheets) do %>
  <%= webpacked_plugins_css_for :foreman_openscap %>
<% end %>


<table id='report_log' class="<%= table_css_classes %>">
  <thead>
    <tr>
      <th><%= _("Result") %></th>
      <th><%= _("Message") %></th>
      <th class="col-md-4"><%= _("Resource") %></th>
      <th class="col-md-1"><%= _("Severity") %></th>
      <th class="col-md-1"><%= _("Actions") %></th>
    </tr>
  </thead>
  <tbody>
    <%
      body.each_with_index do |record, index|
        result, title, ident, severity, description, rationale, references, fixes = record
    %>
      <tr>
        <td><span <%= result_tag result %>><%= h result %></span></td>
        <td>
          <%= render :partial => 'detailed_message', :locals => { ix: index, message: title, description: description, rationale: rationale, references: references, fixes: fixes } %>
        </td>
        <td><%= ident %></td>
        <td><%= react_component 'RuleSeverity', { :severity => severity&.downcase } %></td>
        <td><%= host_search_by_rule_result_buttons(ident) %></td>
      </tr>
    <% end %>
    <tr id='ntsh' <%= "style='display: none;'".html_safe if body.size > 0%>>
      <td colspan="4">
        <div class="alert alert-warning" role="alert"><%= _("Nothing to show") %></div>
      </td>
    </tr>
  </tbody>
</table>
